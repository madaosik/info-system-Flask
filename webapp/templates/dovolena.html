{% extends "base.html" %}

{% block app_content %}
    <h3>Dovolená k schválení</h3>

    {%  if all %}
        <table class="centertable table table-hover table-sm center">
            <thead class="thead-light">
            <tr>
                <th>Křestní jméno</th>
                <th>Příjmení</th>
                <th>Datum začátku</th>
                <th>Datum konce</th>
                <th>Celkem dní</th>
                <th colspan="2">Potvrzení</th>
            </tr>
            </thead>
    {% else %}
        <p>Neevidujeme žádné žádosti o dovolenou.</p>
    {% endif %}
    {% for dovolena in all %}
        {% if dovolena.potvrzeni == False %}
        <tr>
            {% for zamestnanec in empl %}
                    {% if zamestnanec.id_zam == dovolena.id_zam %}
                        <td>{{ zamestnanec.kr_jmeno }}</td>
                        <td>{{zamestnanec.prijmeni}}</td>
                    {% endif %}
                {% endfor %}
            <td>{{dovolena.od}}</td>
            <td>{{dovolena.do}}</td>
            <td>{{dovolena.celkem}}</td>
            <td>
                <form method="POST" action="{{ url_for('schvalit', entity='dovolena_zaznam', id = dovolena.id_zaznamu) }}">
                  <input type="submit" value=&#9745; class="btn approve_button">
                </form>
            </td>
            <td>
                <form method="POST" action="{{ url_for('smazat', entity='dovolena_zaznam', id = dovolena.id_zaznamu) }}">
                  <input type="submit" value=&#9746; class="btn deny_button">
                </form>
            </td>
        </tr>
        {% endif %}
    {% endfor %}
    {% if all %}
        </table>
    {%  endif %}
<br><br>
    <h3>Schválená nadcházející dovolená</h3>
        <table class="centertable table table-hover table-sm">
            <thead class="thead-light">
            <tr>
                <th>Křestní jméno</th>
                <th>Příjmení</th>
                <th>Datum začátku</th>
                <th>Datum konce</th>
                <th>Celkem dní</th>
                <th>Zrušit</th>
            </tr>
            </thead>
    {% for dovolena in all %}
        {% if dovolena.potvrzeni == True and dovolena.do > date %}
        <tr>
            {% for zamestnanec in empl %}
                    {% if zamestnanec.id_zam == dovolena.id_zam %}
                        <td>{{ zamestnanec.kr_jmeno }}</td>
                        <td>{{zamestnanec.prijmeni}}</td>
                    {% endif %}
                {% endfor %}

            <td>{{dovolena.od}}</td>
            <td>{{dovolena.do}}</td>
            <td>{{dovolena.celkem}}</td>
            <td>
                <form method="POST" action="{{ url_for('smazat', entity='dovolena_zaznam', id = dovolena.id_zaznamu) }}">
                  <input type="submit" value=&#9746; class="btn deny_button">
                </form>
            </td>
        </tr>
        {% endif %}
    {% endfor %}
        </table>


    <br><br>
    <a class="btn btn-secondary" href="{{ url_for('show_vsetkydovolene',entity='dovolena_zaznam') }}">Přejít na historii</a>

    <script type="text/javascript">
            $(document).ready(function () {
                var vacations = new Array();

                var vacation1 = {
                id: "id1",
                description: "Jan jede na hory.",
                location: "",
                subject: "Hory: Jan",
                calendar: "Pozadano",
                start: new Date(2018, 11, 5, 0, 0, 0),
                end: new Date(2018, 11, 17 , 0, 0, 0)
            }

            var vacation2 = {
                id: "id2",
                description: "",
                location: "",
                subject: "Petr stavi dum",
                calendar: "Schvaleno",
                start: new Date(2018, 11, 8, 0, 0, 0),
                end: new Date(2018, 11, 24, 0, 0, 0)
            }

            var vacation3 = {
                id: "id3",
                description: "",
                location: "",
                subject: "Honza stavi dum",
                calendar: "Schvaleno",
                start: new Date(2018, 11, 08, 0, 0, 0),
                end: new Date(2018, 11, 24, 0, 0, 0)
            }

            vacations.push(vacation1);
            vacations.push(vacation2);
            vacations.push(vacation3);

            // prepare the data
            var source =
            {
                dataType: "array",
                dataFields: [
                    { name: 'id', type: 'string' },
                    { name: 'description', type: 'string' },
                    { name: 'location', type: 'string' },
                    { name: 'subject', type: 'string' },
                    { name: 'calendar', type: 'string' },
                    { name: 'start', type: 'date' },
                    { name: 'end', type: 'date' }
                ],
                id: 'id',
                localData: vacations
            };
            var adapter = new $.jqx.dataAdapter(source);
            $("#scheduler").jqxScheduler({
                date: new $.jqx.date(2018, 11, 4),
                width: 850,
                height: 600,
                source: adapter,
                view: 'monthView',
                showLegend: true,
                ready: function () {
                    $("#scheduler").jqxScheduler('ensureAppointmentVisible', 'id1');
                },
                resources:
                {
                    colorScheme: "scheme05",
                    dataField: "calendar",
                    source:  new $.jqx.dataAdapter(source)
                },
                appointmentDataFields:
                {
                    from: "start",
                    to: "end",
                    id: "id",
                    description: "description",
                    location: "place",
                    subject: "subject",
                    resourceId: "calendar"
                },
                views:
                [
                    { type: 'monthView', showWeekNumbers: true }
                ]
            });
            });
    </script>
    <div id="scheduler"></div>

{% endblock %}